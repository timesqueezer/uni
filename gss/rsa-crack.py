#!/usr/bin/env python

c_list = [
    57070, 1958, 25663, 48313, 10061, 14424, 63654, 25663, 10061, 13971, 55389, 55389,
    101638, 2063, 78893, 75311, 1958, 103574, 1958, 48313, 10061, 103574, 63654, 5060,
    14424, 10061, 59046, 88159, 78893, 12575, 25663, 5060, 14424, 25663, 10061, 97002,
    81424, 25663, 87275, 25663, 5060, 10061, 82006, 63654, 75857, 81424, 88533, 63654,
    12575, 42900, 10061, 7580, 5060, 12575, 48313, 25663, 63654, 59046, 25663, 48313,
    87275, 88159, 14424, 25663, 78893, 78893, 25663, 82317, 10061, 55389, 75857, 81424,
    1958, 88533, 105842, 105842, 63654, 25663, 78893, 25663, 82317, 10061, 103717,
    75311, 63654, 5060, 99350, 88159, 82006, 10061, 97002, 75311, 99350, 78893, 25663,
    103574, 82317, 10061, 14424, 63654, 25663, 10061, 88844, 26360, 5060, 101638, 56225,
    55389, 63654, 75857, 81424, 25663, 48313, 81424, 25663, 63654, 88533, 10061, 88932,
    88159, 5060, 10061, 82525, 75311, 103574, 103574, 82006, 88159, 25663, 48313, 88533,
    25663, 48313, 5060, 10061, 1958, 5060, 14424, 10061, 14424, 75311, 105842, 1958,
    12575, 25663, 81424, 88159, 25663, 48313, 63654, 12575, 25663, 10061, 7580, 5060,
    12575, 48313, 63654, 59046, 59046, 25663, 82317, 10061, 22883, 1958, 12575, 75311,
    5060, 12575, 103574, 101638, 10061, 1958, 5060, 14424, 10061, 22883, 1958, 12575,
    48313, 63654, 59046, 59046, 103574, 55080, 88159, 5060, 88533, 48313, 88159, 78893,
    78893, 25663, 82317, 10061, 97002, 63654, 87275, 63654, 5060, 12575, 101638, 7580,
    88533, 88533, 75311, 75857, 55080, 10061, 1958, 5060, 14424, 10061, 82525, 88159,
    82006, 25663, 48313, 101638, 7580, 5060, 75311, 78893, 70957, 103574, 63654, 103574,
    82317, 10061, 80405, 63654, 88159, 87275, 25663, 88533, 48313, 63654, 103574, 75857,
    81424, 25663, 10061, 1153, 25663, 48313, 59046, 75311, 81424, 48313, 25663, 5060,
    82317, 10061, 13971, 48313, 1958, 5060, 14424, 78893, 75311, 12575, 25663, 5060,
    10061, 14424, 25663, 48313, 10061, 2063, 48313, 70957, 25152, 88533, 88159, 12575,
    48313, 75311, 25152, 81424, 63654, 25663, 82317, 10061, 14424, 75311, 103574, 10061,
    103717, 55389, 7580, 101638, 1153, 25663, 48313, 59046, 75311, 81424, 48313, 25663,
    5060, 82317, 10061, 7580, 1958, 88533, 81424, 25663, 5060, 88533, 63654, 59046,
    63654, 55080, 75311, 88533, 63654, 88159, 5060, 103574, 25152, 48313, 88159, 88533,
    88159, 55080, 88159, 78893, 78893, 25663, 10061, 1958, 5060, 14424, 10061, 5060,
    75311, 88533, 1958, 25663, 48313, 78893, 63654, 75857, 81424, 10061, 75311, 78893,
    78893, 25663, 10061, 75311, 5060, 14424, 25663, 48313, 25663, 5060, 10061, 105486,
    5060, 81424, 75311, 78893, 88533, 25663, 82317, 10061, 14424, 63654, 25663, 10061,
    63654, 5060, 10061, 26360, 25663, 99350, 1958, 5060, 12575, 10061, 1958, 5060, 14424,
    10061, 1153, 88159, 48313, 78893, 25663, 103574, 1958, 5060, 12575, 10061, 99350,
    25663, 81424, 75311, 5060, 14424, 25663, 78893, 88533, 10061, 82006, 1958, 48313,
    14424, 25663, 5060, 66292, 10061, 42900, 101638, 56225
]

# import sys
# sys.setrecursionlimit(1000000)


def egcd(a, b):
    '''
    Extended Euclidien algorithm

    :returns (g, x, y) a*x + b*y = gcd(x, y)
    '''

    if a == 0:
        return (b, 0, 1)

    else:
        g, x, y = egcd(b % a, a)
        return (g, y - (b // a) * x, x)


if __name__ == '__main__':
    p = 307
    q = 353
    e = 35

    N = p * q
    phi_n = (p - 1) * (q - 1)

    _, d, k = egcd(e, phi_n)

    print(f'd: {d}')

    m_list = []

    for c in c_list:
        result = pow(c, d) % N
        m_list.append(result)

    print('Originalnachricht:')
    # decode ascii
    print(''.join([chr(m) for m in m_list]))
